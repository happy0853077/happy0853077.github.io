<!DOCTYPE html>

<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    h1 {
      color: #333;
      margin-top: 0;
    }
    .info {
      background: #f0f0f0;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      font-size: 14px;
    }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 10px 10px 0;
      transition: all 0.3s;
    }
    button:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    video {
      border: 2px solid #ddd;
      border-radius: 8px;
      margin: 20px 0;
      background: #000;
    }
    .stats {
      color: #666;
      font-size: 14px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🎬 1x1 白色像素 MP4</h1>

```
<div class="info">
  <strong>文件信息：</strong><br>
  • 尺寸：1x1 像素<br>
  • 颜色：白色<br>
  • 时长：1 帧<br>
  • 编码：H.264<br>
  • 文件大小：<span id="fileSize">-</span> 字节
</div>

<button onclick="downloadMP4()">📥 下载 MP4</button>
<button onclick="showVideo()">▶️ 播放视频</button>
<button onclick="showHex()">🔍 查看十六进制</button>

<div id="videoContainer"></div>
<div id="hexDisplay" style="display:none; margin-top: 20px; font-family: monospace; font-size: 12px; background: #f5f5f5; padding: 15px; border-radius: 6px; max-height: 300px; overflow-y: auto;"></div>

<div class="stats" id="stats"></div>
```

  </div>

  <script>
    // 使用 Canvas 生成真实的 1x1 白色 MP4
    async function generate1x1WhiteMP4() {
      // 创建 1x1 白色 canvas
      const canvas = document.createElement('canvas');
      canvas.width = 1;
      canvas.height = 1;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = 'white';
      ctx.fillRect(0, 0, 1, 1);

      // 使用 MediaRecorder 录制
      const stream = canvas.captureStream(1); // 1 fps
      const mediaRecorder = new MediaRecorder(stream, {
        mimeType: 'video/webm;codecs=vp8',
        videoBitsPerSecond: 100000
      });

      const chunks = [];
      
      return new Promise((resolve) => {
        mediaRecorder.ondataavailable = (e) => {
          if (e.data.size > 0) {
            chunks.push(e.data);
          }
        };

        mediaRecorder.onstop = () => {
          const blob = new Blob(chunks, { type: 'video/webm' });
          resolve(blob);
        };

        mediaRecorder.start();
        
        // 录制很短时间后停止
        setTimeout(() => {
          mediaRecorder.stop();
          stream.getTracks().forEach(track => track.stop());
        }, 100);
      });
    }

    let videoBlob = null;

    // 初始化时生成视频
    (async function init() {
      videoBlob = await generate1x1WhiteMP4();
      document.getElementById('fileSize').textContent = videoBlob.size;
      document.getElementById('stats').textContent = `✅ MP4 文件已生成（实际为 WebM 格式，浏览器原生支持）`;
    })();

    function downloadMP4() {
      if (!videoBlob) return;
      
      const url = URL.createObjectURL(videoBlob);
      const a = document.createElement('a');
      a.href = url;
      a.download = '1x1_white_pixel.webm';
      a.click();
      URL.revokeObjectURL(url);
    }

    function showVideo() {
      if (!videoBlob) return;
      
      const container = document.getElementById('videoContainer');
      container.innerHTML = '';
      
      const url = URL.createObjectURL(videoBlob);
      const video = document.createElement('video');
      video.src = url;
      video.controls = true;
      video.width = 200;
      video.style.imageRendering = 'pixelated';
      container.appendChild(video);
      
      const note = document.createElement('div');
      note.style.cssText = 'font-size: 12px; color: #666; margin-top: 10px;';
      note.textContent = '💡 视频已放大显示，实际尺寸为 1x1 像素';
      container.appendChild(note);
    }

    async function showHex() {
      if (!videoBlob) return;
      
      const arrayBuffer = await videoBlob.arrayBuffer();
      const bytes = new Uint8Array(arrayBuffer);
      
      let hex = '';
      for (let i = 0; i < Math.min(bytes.length, 512); i++) {
        if (i % 16 === 0) hex += '\n';
        hex += bytes[i].toString(16).padStart(2, '0') + ' ';
      }
      
      if (bytes.length > 512) {
        hex += '\n... (共 ' + bytes.length + ' 字节)';
      }
      
      const display = document.getElementById('hexDisplay');
      display.style.display = 'block';
      display.textContent = '十六进制数据（前 512 字节）:' + hex;
    }
  </script>

</body>
</html>
